<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Animals Everywhere! - Wayfinding Map</title>
    <link rel="preload" href="../assets/fonts/Amatic SC Regular.ttf" as="font" type="font/ttf" crossorigin>
    <link rel="preload" href="../assets/fonts/Amatic-Bold.ttf" as="font" type="font/ttf" crossorigin>
    <link rel="stylesheet" href="./scripts/style.css">
    <link rel="stylesheet" href="./scripts/wayfinding.css">
</head>
<body>
    <button class="back-button" id="backButton" aria-label="Back to menu">
        <img src="./assets/ui/Arrow.svg" alt="Back">
    </button>
    
    <button class="help-button" id="helpButton" aria-label="Help">
        <img src="./assets/ui/Help.svg" alt="Help">
    </button>
    
    <!-- Orientation Warning Overlay -->
    <div id="orientationOverlay" class="orientation-overlay hidden">
        <div class="orientation-content">
            <div class="orientation-icon">ðŸ“±</div>
            <h2>Please Rotate Your Device</h2>
            <p>Hold your device in portrait mode for the best experience</p>
        </div>
    </div>

    <!-- Instructions Overlay -->
    <div id="instructionsOverlay" class="instructions-overlay hidden">
        <div class="instructions-content">
            <h2>How to Use the Map</h2>
            <ul>
                <li>Move around and watch your location on the map</li>
                <li>Follow hotspots to find animals</li>
                <li>You will get an alert when you are close</li>
                <li>Scan the area to collect the animal and its badge</li>
            </ul>
            <button class="instructions-close" id="instructionsClose">Got it!</button>
        </div>
    </div>

    <!-- Leave Confirmation Overlay -->
    <div id="leaveConfirmationOverlay" class="instructions-overlay hidden">
        <div class="instructions-content">
            <h2>Leaving the map</h2>
            <p class="leave-confirm-message">Stay on this page to be notified where animals are.</p>
            <div class="leave-confirm-buttons">
                <button class="leave-confirm-close" id="leaveConfirmClose">âœ•</button>
                <button class="instructions-close" id="leaveConfirmButton">Leave</button>
            </div>
        </div>
    </div>

    <!-- Boundary Warning Overlay -->
    <div id="boundaryWarningOverlay" class="instructions-overlay hidden">
        <div class="instructions-content">
            <button class="boundary-warning-close" id="boundaryWarningClose">âœ•</button>
            <h2>Out of bounds</h2>
            <p class="boundary-warning-message">There are no animals here!â€¨Return to the garden grounds to continue your search.</p>
        </div>
    </div>

    <!-- Animal Nearby Popup (slides in from bottom) -->
    <div id="animalNearbyPopup" class="animal-detail-popup hidden">
        <div class="animal-detail-content">
            <button class="animal-detail-close" id="animalNearbyClose" aria-label="Close">
                <img src="./assets/ui/close_button.png" alt="Close">
            </button>
            <h2 class="animal-detail-title" id="animalNearbyTitle">AN ANIMAL IS NEARBY!</h2>
            <p class="animal-detail-message" id="animalNearbyMessage">Open the camera to scan the area.</p>
            <div class="animal-detail-buttons">
                <button class="animal-detail-btn directions-btn" id="animalNearbyOpenCamera">
                    <img src="./assets/ui/Scan.svg" alt="Scan" class="btn-icon">
                    <span>Open camera</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Proximity Info Panel (shows when within 20-25m range) -->
    <div id="proximityNotification" class="proximity-notification hidden"></div>

    <!-- Zoom and Recenter Buttons -->
    <button id="zoomInBtn" class="zoom-btn" aria-label="Zoom in">
        <img src="./assets/ui/Plus.svg" alt="Zoom in">
    </button>
    <button id="zoomOutBtn" class="zoom-btn" aria-label="Zoom out">
        <img src="./assets/ui/Minus.svg" alt="Zoom out">
    </button>
    <button id="recenterBtn" class="recenter-btn" aria-label="Recenter map to your location">
        <img src="./assets/ui/Target.svg" alt="Recenter">
    </button>

    <!-- Map Container -->
    <div class="map-container" id="mapContainer">
        <img src="./assets/horniman_map_new.png" alt="Interactive Map" class="map-image" id="mapImage">
        <div class="user-location-accuracy-circle" id="userLocationAccuracyCircle"></div>
        <div class="user-location-dot" id="userLocationDot"></div>
        <div class="user-location-heading" id="userLocationHeading"></div>
        <div id="animalHotspots"></div>
    </div>

    <!-- Animal Detail Popup (slides in from bottom) -->
    <div id="animalDetailPopup" class="animal-detail-popup hidden">
        <div class="animal-detail-content">
            <button class="animal-detail-close" id="animalDetailClose" aria-label="Close">
                <img src="./assets/ui/close_button.png" alt="Close">
            </button>
            <h2 class="animal-detail-title" id="animalDetailTitle">???</h2>
            <p class="animal-detail-message" id="animalDetailMessage">What could this be?</p>
            <div class="animal-detail-buttons">
                <button class="animal-detail-btn directions-btn" id="animalDetailDirections">
                    <img src="./assets/ui/Directions.svg" alt="Directions" class="btn-icon">
                    <span>Directions</span>
                </button>
                <button class="animal-detail-btn details-btn" id="animalDetailDetails">
                    <img src="./assets/ui/Details.svg" alt="Details" class="btn-icon">
                    <span>Details</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Directions Popup (slides in from bottom) -->
    <div id="directionsPopup" class="animal-detail-popup hidden">
        <div class="animal-detail-content">
            <button class="animal-detail-close" id="directionsClose" aria-label="Close">
                <img src="./assets/ui/close_button.png" alt="Close">
            </button>
            <h2 class="animal-detail-title" id="directionsTitle">0M AWAY</h2>
            <p class="animal-detail-message" id="directionsMessage">Your route is ready. Head to the marked area to scan this animal.</p>
        </div>
    </div>

    <!-- Animal Details Overlay (full screen, like animals page) -->
    <div id="animalDetailsOverlay" class="badge-detail-popup hidden">
        <div class="starburst-background-overlay"></div>
        <button class="back-button" id="animalDetailsBackButton">
            <img src="../assets/Arrow.png" alt="Back">
        </button>
        <h1 class="title">ANIMAL DETAILS</h1>
        
        <div class="badge-detail-main">
            <img id="animalDetailsIcon" src="" alt="Animal" class="badge-detail-icon">
            <h2 id="animalDetailsName" class="badge-detail-name"></h2>
            <p id="animalDetailsDate" class="badge-detail-date"></p>
            <p id="animalDetailsDescription" class="badge-detail-description"></p>
            <div class="badge-detail-buttons">
                <button id="animalDetailsPlayGameButton" class="secondaryButton hidden">Play Game</button>
            </div>
        </div>
    </div>


    <!-- Customer.io Helper (loads before Customer.io snippet) -->
    <script src="../customer-io-helper.js"></script>
    <!-- Customer.io snippet will go here when available -->
    
    <script src="../scripts/audio-manager-main.js"></script>
    <script src="./scripts/map-config.js"></script>
    <script src="./scripts/wayfinding.js"></script>
</body>
</html>

